<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Deep dive into OpenCode architecture: agents, skills, tools, and permissions. Learn how to create custom AI agents and understand the modular architecture.">
    <meta name="keywords" content="OpenCode, AI agents, agent architecture, custom agents, AI skills, OpenCode tutorial, agent configuration">
    <meta name="author" content="Jiuhe Wang">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://jiuhewang.dev/opencode-deep-dive.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://jiuhewang.dev/opencode-deep-dive.html">
    <meta property="og:title" content="OpenCode Architecture Overview: Agents & Skills">
    <meta property="og:description" content="Deep dive into OpenCode architecture: agents, skills, tools, and permissions. Learn how to create custom AI agents.">
    <meta property="og:site_name" content="Mind & Machine">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jiuhewang.dev/opencode-deep-dive.html">
    <meta property="twitter:title" content="OpenCode Architecture: Agents & Skills">
    <meta property="twitter:description" content="Deep dive into OpenCode architecture: agents, skills, tools, and permissions.">

    <title>OpenCode Architecture: Agents, Skills & Tools Guide | Mind & Machine</title>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Nunito:wght@400;600;700&family=Patrick+Hand&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="static/styles.css">
    <style>
        /* Page-specific styles only */
        .page-wrapper {
            display: flex;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 40px 40px;
            max-width: calc(100vw - 320px);
            min-width: 0;
        }

        .container { max-width: 100%; margin: 0 auto; }

        /* Mobile TOC Toggle */
        .toc-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 200;
            background: var(--accent-coral);
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        @media (max-width: 1200px) {
            .main-content {
                margin-left: 0;
                padding: 40px 20px;
                max-width: 100%;
            }
            .toc-toggle { display: block; }
            .back-link { margin-top: 50px; }
        }

        header { text-align: center; margin-bottom: 50px; }

        h1 {
            font-family: 'Caveat', cursive;
            font-size: 3.2rem;
            color: var(--pencil);
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--accent-coral), var(--accent-teal), var(--accent-sunflower));
            border-radius: 3px;
            opacity: 0.6;
        }

        .subtitle { font-family: 'Patrick Hand', cursive; font-size: 1.5rem; color: var(--text-muted); margin-top: 20px; }

        .back-link {
            display: inline-block;
            color: var(--accent-teal);
            font-family: 'Patrick Hand', cursive;
            font-size: 1.1rem;
            text-decoration: none;
            margin-bottom: 30px;
            transition: color 0.3s;
        }
        .back-link:hover { color: var(--accent-coral); }

        .page-meta {
            font-family: 'Patrick Hand', cursive;
            font-size: 0.95rem;
            color: var(--text-muted);
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
        }
        .page-meta i { margin-right: 5px; }

        .card {
            background: var(--bg-paper);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 40px;
            margin-bottom: 28px;
            box-shadow: 3px 4px 0 rgba(0,0,0,0.1), 6px 8px 0 rgba(0,0,0,0.05);
            position: relative;
            transition: transform 0.3s ease;
            border: 2px solid var(--pencil);
        }

        .card:hover { transform: translate(-2px, -2px); }

        h2 { 
            font-family: 'Caveat', cursive; 
            font-size: 2.2rem; 
            color: var(--pencil); 
            margin-bottom: 20px;
            padding-left: 50px;
            position: relative;
            min-height: 45px;
            display: flex;
            align-items: center;
        }

        h2 .fa-icon {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 42px;
            height: 42px;
            background: var(--bg-paper);
            border: 2px solid var(--pencil);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        h3 { font-family: 'Patrick Hand', cursive; font-size: 1.5rem; color: var(--text-dark); margin: 30px 0 15px; }
        h4 { font-family: 'Patrick Hand', cursive; font-size: 1.2rem; color: var(--text-muted); margin: 20px 0 10px; }
        p { margin-bottom: 15px; font-size: 1.08rem; }

        .highlight { background: linear-gradient(180deg, transparent 65%, rgba(255, 230, 109, 0.5) 65%); }
        .highlight-teal { background: linear-gradient(180deg, transparent 65%, rgba(78, 205, 196, 0.35) 65%); }
        .highlight-coral { background: linear-gradient(180deg, transparent 65%, rgba(255, 107, 107, 0.35) 65%); }

        /* Architecture Diagram */
        .arch-diagram {
            background: linear-gradient(135deg, #F8F4FF, #E8F8F5);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 30px;
            margin: 25px 0;
            border: 2px dashed var(--accent-lavender);
        }

        .arch-layer {
            background: var(--bg-paper);
            border: 3px solid var(--pencil);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 18px 25px;
            margin: 12px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.3s;
        }

        .arch-layer:hover { transform: scale(1.02) rotate(-1deg); }

        .arch-icon {
            width: 45px;
            height: 45px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            flex-shrink: 0;
            border: 2px solid var(--pencil);
        }

        .arch-icon.client { background: var(--accent-coral); color: white; }
        .arch-icon.server { background: var(--accent-teal); color: white; }
        .arch-icon.agent { background: var(--accent-lavender); color: white; }
        .arch-icon.tool { background: var(--accent-orange); color: white; }

        /* Agent Types */
        .agent-types {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 25px 0;
        }

        .agent-box {
            flex: 1;
            min-width: 200px;
            background: var(--bg-paper);
            border: 3px solid var(--pencil);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s;
        }

        .agent-box:hover { transform: scale(1.03) rotate(1deg); }

        .agent-box.primary { border-color: var(--accent-green); background: linear-gradient(145deg, #E8F8F5, #D1F2EB); }
        .agent-box.subagent { border-color: var(--accent-teal); background: linear-gradient(145deg, #E3F2FD, #BBDEFB); }
        .agent-box.system { border-color: var(--accent-lavender); background: linear-gradient(145deg, #E8EAF6, #C5CAE9); }

        .agent-icon { font-size: 2.5rem; margin-bottom: 12px; }
        .agent-title { font-family: 'Patrick Hand', cursive; font-size: 1.3rem; font-weight: 700; margin-bottom: 8px; }
        .agent-desc { font-size: 0.9rem; color: var(--text-muted); }

        /* Code Blocks */
        .code-block {
            background: linear-gradient(135deg, #1E272E 0%, #252F38 100%);
            color: #E8F4F8;
            padding: 0;
            border-radius: 20px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 25px 0;
            overflow-x: auto;
            border: 3px solid var(--pencil);
            box-shadow: 4px 6px 0 rgba(0,0,0,0.2);
        }

        .code-header {
            background: linear-gradient(135deg, #2D3A47 0%, #384554 100%);
            padding: 12px 20px;
            border-bottom: 2px solid #343D46;
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Patrick Hand', cursive;
            font-size: 0.95rem;
            color: #8FA5B5;
        }

        .code-header .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .code-header .dot.red { background: #FF5F56; }
        .code-header .dot.yellow { background: #FFBD2E; }
        .code-header .dot.green { background: #27CA40; }

        .code-content {
            padding: 20px 25px;
            line-height: 1.7;
            white-space: pre;
            overflow-x: auto;
        }

        .code-block .comment { color: #6A9955; font-style: italic; }
        .code-block .key { color: #9CDCFE; font-weight: 600; }
        .code-block .string { color: #CE9178; }
        .code-block .number { color: #B5CEA8; }
        .code-block .boolean { color: #569CD6; }
        .code-block .keyword { color: #C586C0; }
        .code-block .tag { color: #4EC9B0; }
        .code-block .attr { color: #9CDCFE; }
        .code-block .prompt { color: #4ECDC4; font-weight: 700; }
        .code-block .command { color: #FFE66D; }
        .code-block .path { color: #FF6B6B; }
        .code-block .operator { color: #D4D4D4; }
        .code-block .punctuation { color: #D4D4D4; }

        /* Line numbers for code */
        .code-with-lines { counter-reset: line; }
        .code-line { display: block; padding: 2px 0; }
        .code-line::before {
            counter-increment: line;
            content: counter(line);
            display: inline-block;
            width: 30px;
            text-align: right;
            margin-right: 15px;
            color: #5C6770;
            font-size: 0.8rem;
        }

        /* Feature List */
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 18px 0;
        }

        .feature-list li {
            padding: 12px 0 12px 38px;
            position: relative;
            border-bottom: 2px dashed rgba(0,0,0,0.1);
        }

        .feature-list li::before {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free', sans-serif;
            font-weight: 900;
            position: absolute;
            left: 0;
            font-size: 1.1rem;
            color: var(--accent-teal);
        }

        /* Quote Box */
        .quote-box {
            background: linear-gradient(135deg, #FFF9E6, #FFF5D6);
            border-left: 5px solid var(--accent-sunflower);
            padding: 20px 25px;
            margin: 20px 0;
            border-radius: 0 16px 16px 0;
            font-size: 1.12rem;
            font-style: italic;
            border: 2px dashed var(--accent-sunflower);
        }

        /* Insight Box */
        .insight-box {
            background: linear-gradient(135deg, #FFFDE7, #FFF9C4);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 22px;
            margin: 22px 0;
            display: flex;
            align-items: flex-start;
            gap: 16px;
            border: 3px solid var(--accent-sunflower);
        }

        .insight-icon { font-size: 1.8rem; color: var(--accent-sunflower); }

        /* Table */
        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 22px 0;
            font-size: 0.95rem;
            border: 2px solid var(--pencil);
            border-radius: 15px;
            overflow: hidden;
        }

        .comparison-table th, .comparison-table td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 2px dashed rgba(0,0,0,0.15);
        }

        .comparison-table th {
            font-family: 'Patrick Hand', cursive;
            font-size: 1.15rem;
            background: #F5F0E8;
        }

        /* Skill Path Visualization */
        .skill-paths {
            background: linear-gradient(135deg, #F0F8FF, #E6F3FF);
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            padding: 25px;
            margin: 20px 0;
            border: 2px dashed var(--accent-teal);
        }

        .path-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .path-icon { color: var(--accent-teal); font-size: 1.2rem; }
        .path-scope { font-weight: bold; min-width: 80px; }

        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-family: 'Patrick Hand', cursive;
        }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.7s ease; }
        .reveal.visible { opacity: 1; transform: translateY(0); }

        /* Enhanced Mobile Styles */
        @media (max-width: 1200px) {
            .page-wrapper {
                flex-direction: column;
            }
            
            .main-content {
                margin-left: 0;
                padding: 40px 20px;
                max-width: 100%;
                width: 100%;
                min-width: 0;
            }
            
            .container {
                max-width: 100%;
                width: 100%;
                overflow-x: hidden;
            }
        }
        
        @media (max-width: 768px) {
            html, body {
                overflow-x: hidden;
                width: 100%;
                max-width: 100vw;
            }
            
            body { 
                padding: 0;
            }
            
            .page-wrapper {
                width: 100%;
                max-width: 100%;
            }
            
            .main-content {
                padding: 20px 15px;
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }
            
            .container {
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
            }
            
            h1 { 
                font-size: 1.8rem;
                word-wrap: break-word;
            }
            
            .subtitle { 
                font-size: 1.1rem; 
            }
            
            .card { 
                padding: 20px 15px; 
                margin-bottom: 20px;
                width: 100%;
                box-sizing: border-box;
                max-width: 100%;
            }
            
            h2 { 
                font-size: 1.3rem; 
                padding-left: 40px; 
            }
            
            h2 .fa-icon { 
                width: 32px; 
                height: 32px; 
                font-size: 1rem; 
            }
            
            .arch-layer { 
                padding: 15px; 
                flex-direction: column; 
                text-align: center;
                width: 100%;
                box-sizing: border-box;
            }
            
            .arch-icon { 
                margin: 0 auto 10px; 
            }
            
            .arch-diagram {
                width: 100%;
                box-sizing: border-box;
            }
            
            .comparison-table { 
                font-size: 0.8rem; 
                display: block; 
                overflow-x: auto;
                white-space: nowrap;
                max-width: 100%;
            }
            
            .comparison-table th,
            .comparison-table td {
                padding: 8px 10px;
            }
            
            .code-block {
                max-width: 100%;
                overflow-x: auto;
            }
            
            .code-content { 
                padding: 12px 15px; 
                font-size: 0.8rem;
                overflow-x: auto;
                white-space: pre;
                max-width: 100%;
            }
            
            .agent-types {
                width: 100%;
            }
            
            .agent-box {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }
            
            .skill-paths {
                width: 100%;
                box-sizing: border-box;
            }
            
            .path-item {
                flex-wrap: wrap;
            }
            
            .insight-box {
                width: 100%;
                box-sizing: border-box;
            }
        }
        
        @media (max-width: 480px) {
            h1 { font-size: 1.6rem; }
            h2 { font-size: 1.1rem; padding-left: 35px; }
            h2 .fa-icon { width: 28px; height: 28px; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <!-- Background doodles -->
    <div class="bg-doodle bg-doodle-1"><i class="fa-solid fa-code"></i></div>
    <div class="bg-doodle bg-doodle-2"><i class="fa-solid fa-robot"></i></div>
    <div class="bg-doodle bg-doodle-3"><i class="fa-solid fa-book"></i></div>
    <div class="bg-doodle bg-doodle-4"><i class="fa-solid fa-server"></i></div>
    <div class="bg-doodle bg-doodle-5"><i class="fa-solid fa-toolbox"></i></div>

    <button class="toc-toggle" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></button>

    <div class="page-wrapper">
        <!-- Sidebar Table of Contents -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">OpenCode Architecture</div>
                <div class="sidebar-subtitle">Navigation Guide</div>
            </div>

            <div class="toc-section">
                <div class="toc-title"><i class="fa-solid fa-book-open"></i> Overview</div>
                <ul class="toc-list">
                    <li><a href="#executive-summary" onclick="scrollToSection('executive-summary')">Executive Summary</a></li>
                    <li><a href="#system-architecture" onclick="scrollToSection('system-architecture')">System Architecture</a></li>
                </ul>
            </div>

            <div class="toc-section">
                <div class="toc-title"><i class="fa-solid fa-robot"></i> Agents</div>
                <ul class="toc-list">
                    <li><a href="#how-agents-work" onclick="scrollToSection('how-agents-work')">How Agents Work</a></li>
                    <li><a href="#creating-custom-agents" onclick="scrollToSection('creating-custom-agents')">Creating Custom Agents</a></li>
                </ul>
            </div>

            <div class="toc-section">
                <div class="toc-title"><i class="fa-solid fa-book"></i> Skills & Tools</div>
                <ul class="toc-list">
                    <li><a href="#skills-system" onclick="scrollToSection('skills-system')">The Skills System</a></li>
                </ul>
            </div>

            <div class="toc-section">
                <div class="toc-title"><i class="fa-solid fa-clipboard-check"></i> Summary & Reference</div>
                <ul class="toc-list">
                    <li><a href="#key-takeaways" onclick="scrollToSection('key-takeaways')">Key Takeaways</a></li>
                    <li><a href="#project-file-structure" onclick="scrollToSection('project-file-structure')">Project File Structure</a></li>
                </ul>
            </div>

            <div class="toc-section" style="margin-top: 30px; padding-top: 20px; border-top: 2px dashed rgba(0,0,0,0.1);">
                <a href="index.html" style="display: flex; align-items: center; gap: 8px; color: var(--accent-teal); text-decoration: none; font-weight: 600;">
                    <i class="fa-solid fa-arrow-left"></i> Back to Home
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <a href="index.html" class="back-link"><i class="fa-solid fa-arrow-left"></i> Back to Mind & Machine</a>
                
                <div class="page-meta">
                    <span><i class="fa-solid fa-user"></i> Jiuhe Wang</span>
                    <span><i class="fa-regular fa-calendar"></i> Feb 21, 2025</span>
                </div>

                <header>
                    <h1>OpenCode Architecture Overview</h1>
                    <p class="subtitle">Understanding Agents &amp; Skills</p>
                </header>

                <!-- Executive Summary -->
                <section class="card reveal" id="executive-summary">
                    <h2><i class="fa-solid fa-rocket fa-icon"></i>Executive Summary</h2>
                    
                    <p><span class="highlight">OpenCode</span> is an open-source AI coding agent with a modular architecture that separates concerns into <strong>agents</strong>, <strong>tools</strong>, <strong>skills</strong>, and <strong>permissions</strong>. It uses a client/server design where the TUI is just one possible frontend.</p>

                    <div class="insight-box">
                        <i class="fa-solid fa-lightbulb insight-icon"></i>
                        <div><strong>Key Insight:</strong> Unlike Claude Code which is coupled to Anthropic, OpenCode is provider-agnostic and can work with Claude, OpenAI, Google, or even local models.</div>
                    </div>
                </section>

                <!-- System Architecture -->
                <section class="card reveal" id="system-architecture">
                    <h2><i class="fa-solid fa-layer-group fa-icon"></i>System Architecture</h2>
                    
                    <div class="arch-diagram">
                        <div style="text-align: center; font-family: 'Patrick Hand', cursive; font-size: 1.2rem; margin-bottom: 15px;">Client/Server Design</div>
                        
                        <div class="arch-layer">
                            <div class="arch-icon client"><i class="fa-solid fa-desktop"></i></div>
                            <div><strong>Client Layer</strong> — TUI, Desktop App, VS Code Extension</div>
                        </div>
                        
                        <div style="text-align: center; color: var(--text-muted); font-size: 1.5rem;">↓ WebSocket/IPC</div>
                        
                        <div class="arch-layer">
                            <div class="arch-icon server"><i class="fa-solid fa-server"></i></div>
                            <div><strong>Server Layer</strong> — Agent Engine, Tool Registry, Skill Registry</div>
                        </div>
                        
                        <div class="arch-layer">
                            <div class="arch-icon agent"><i class="fa-solid fa-robot"></i></div>
                            <div><strong>Agents</strong> — Primary, Subagents, System</div>
                        </div>
                        
                        <div class="arch-layer">
                            <div class="arch-icon tool"><i class="fa-solid fa-toolbox"></i></div>
                            <div><strong>Tools</strong> — bash, read, edit, grep, glob, skill...</div>
                        </div>
                    </div>

                    <h3>Key Design Principles</h3>
                    <ul class="feature-list">
                        <li><strong>Provider Agnostic:</strong> Not tied to any specific LLM provider</li>
                        <li><strong>Modular Tools:</strong> Plugin-based tool system with built-in and custom tools</li>
                        <li><strong>Skill System:</strong> Reusable instruction sets loaded on-demand</li>
                        <li><strong>Permission-First:</strong> Fine-grained access control for all operations</li>
                        <li><strong>Client/Server:</strong> Can run headless and be driven remotely</li>
                    </ul>
                </section>

                <!-- How Agents Work -->
                <section class="card reveal" id="how-agents-work">
                    <h2><i class="fa-solid fa-users fa-icon"></i>How Agents Work</h2>
                    
                    <h3>Agent Types</h3>
                    
                    <div class="agent-types">
                        <div class="agent-box primary">
                            <div class="agent-icon"><i class="fa-solid fa-hammer"></i></div>
                            <div class="agent-title">Primary Agents</div>
                            <div class="agent-desc">Switched with Tab key. User-facing main assistants.</div>
                            <div style="margin-top: 10px; font-size: 0.85rem;"><strong>Examples:</strong> build, plan</div>
                        </div>
                        
                        <div class="agent-box subagent">
                            <div class="agent-icon"><i class="fa-solid fa-user-group"></i></div>
                            <div class="agent-title">Subagents</div>
                            <div class="agent-desc">Invoked via @mention. Specialized task agents.</div>
                            <div style="margin-top: 10px; font-size: 0.85rem;"><strong>Examples:</strong> general, explore, custom</div>
                        </div>
                        
                        <div class="agent-box system">
                            <div class="agent-icon"><i class="fa-solid fa-gear"></i></div>
                            <div class="agent-title">System Agents</div>
                            <div class="agent-desc">Hidden, automatic. Run in background.</div>
                            <div style="margin-top: 10px; font-size: 0.85rem;"><strong>Examples:</strong> compaction, title, summary</div>
                        </div>
                    </div>

                    <h3>Agent Schema</h3>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>opencode.json</span>
                        </div>
                        <div class="code-content">
<span class="punctuation">{</span>
  <span class="key">"name"</span><span class="operator">:</span> <span class="string">"security-audit"</span><span class="punctuation">,</span>
  <span class="key">"description"</span><span class="operator">:</span> <span class="string">"Security-focused code reviewer"</span><span class="punctuation">,</span>
  <span class="key">"mode"</span><span class="operator">:</span> <span class="string">"subagent"</span><span class="punctuation">,</span>  <span class="comment">// primary | subagent | all</span>
  <span class="key">"model"</span><span class="operator">:</span> <span class="punctuation">{</span>
    <span class="key">"providerID"</span><span class="operator">:</span> <span class="string">"anthropic"</span><span class="punctuation">,</span>
    <span class="key">"modelID"</span><span class="operator">:</span> <span class="string">"claude-sonnet"</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="key">"temperature"</span><span class="operator">:</span> <span class="number">0.1</span><span class="punctuation">,</span>  <span class="comment">// 0.0-1.0 creativity</span>
  <span class="key">"color"</span><span class="operator">:</span> <span class="string">"#FF6B6B"</span><span class="punctuation">,</span>
  <span class="key">"tools"</span><span class="operator">:</span> <span class="punctuation">{</span>
    <span class="key">"read"</span><span class="operator">:</span> <span class="boolean">true</span><span class="punctuation">,</span>
    <span class="key">"write"</span><span class="operator">:</span> <span class="boolean">false</span>
  <span class="punctuation">}</span><span class="punctuation">,</span>
  <span class="key">"permission"</span><span class="operator">:</span> <span class="punctuation">[</span><span class="punctuation">]</span>  <span class="comment">// Access control rules</span>
<span class="punctuation">}</span>
                        </div>
                    </div>

                    <h3>Agent Loading Order</h3>
                    <ol style="margin: 15px 0; padding-left: 25px;">
                        <li><strong>Built-in agents</strong> loaded first (build, plan, general, explore)</li>
                        <li><strong>Config file agents</strong> (opencode.json) override or extend</li>
                        <li><strong>Markdown agents</strong> (.opencode/agents/*.md) loaded last</li>
                        <li><strong>Permissions merged</strong> with defaults</li>
                    </ol>
                </section>

                <!-- Creating Custom Agents -->
                <section class="card reveal" id="creating-custom-agents">
                    <h2><i class="fa-solid fa-user-plus fa-icon"></i>Creating Custom Agents</h2>
                    
                    <h3>Method 1: Markdown (Recommended)</h3>
                    
                    <p>Create a file in <span class="highlight-teal">.opencode/agents/</span>:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>.opencode/agents/security-audit.md</span>
                        </div>
                        <div class="code-content">
<span class="comment"># Agent Configuration</span>
<span class="tag">&#45;&#45;&#45;</span>
<span class="attr">description</span><span class="punctuation">:</span> Security-focused code reviewer
<span class="attr">mode</span><span class="punctuation">:</span> subagent
<span class="attr">model</span><span class="punctuation">:</span> anthropic/claude-sonnet-4-20250514
<span class="attr">temperature</span><span class="punctuation">:</span> <span class="number">0.1</span>
<span class="attr">tools</span><span class="punctuation">:</span>
  <span class="attr">read</span><span class="punctuation">:</span> <span class="boolean">true</span>
  <span class="attr">write</span><span class="punctuation">:</span> <span class="boolean">false</span>
  <span class="attr">bash</span><span class="punctuation">:</span> ask
<span class="attr">color</span><span class="punctuation">:</span> <span class="string">"#FF6B6B"</span>
<span class="tag">&#45;&#45;&#45;</span>

<span class="comment"># System Prompt</span>
You are a <span class="keyword">security auditor</span>. Focus on:

<span class="number">1.</span> Injection vulnerabilities (SQL, command, XSS)
<span class="number">2.</span> Authentication issues
<span class="number">3.</span> Data exposure risks
<span class="number">4.</span> Dependency vulnerabilities

Provide <span class="keyword">severity ratings</span> and remediation steps.
                        </div>
                    </div>

                    <div class="quote-box">
                        <strong>Why Markdown?</strong> Version controlled with project, easier to read and maintain, supports long-form prompts, team can collaborate via PRs.
                    </div>

                    <h3>Method 2: JSON Configuration</h3>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>opencode.json</span>
                        </div>
                        <div class="code-content">
<span class="punctuation">{</span>
  <span class="key">"agent"</span><span class="punctuation">:</span> <span class="punctuation">{</span>
    <span class="key">"security-audit"</span><span class="punctuation">:</span> <span class="punctuation">{</span>
      <span class="key">"description"</span><span class="punctuation">:</span> <span class="string">"Security-focused code reviewer"</span><span class="punctuation">,</span>
      <span class="key">"mode"</span><span class="punctuation">:</span> <span class="string">"subagent"</span><span class="punctuation">,</span>
      <span class="key">"prompt"</span><span class="punctuation">:</span> <span class="string">"You are a security auditor..."</span><span class="punctuation">,</span>
      <span class="key">"temperature"</span><span class="punctuation">:</span> <span class="number">0.1</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
                        </div>
                    </div>

                    <h3>Best Practices</h3>
                    
                    <ul class="feature-list">
                        <li><strong>Specific descriptions</strong> — Helps LLM choose correct agent</li>
                        <li><strong>Restricted permissions</strong> — Principle of least privilege</li>
                        <li><strong>Lower temperature</strong> (0.1-0.3) for analysis tasks</li>
                        <li><strong>Color coding</strong> — Visual distinction in UI</li>
                        <li>Use <strong>primary</strong> for user-facing, <strong>subagent</strong> for specialized tasks</li>
                    </ul>
                </section>

                <!-- Skills System -->
                <section class="card reveal" id="skills-system">
                    <h2><i class="fa-solid fa-book fa-icon"></i>The Skills System</h2>
                    
                    <p>Skills are <span class="highlight">reusable instruction documents</span> that agents can load on-demand. Unlike agents (full configurations), skills provide specific domain knowledge or workflows.</p>

                    <h3>Skill Discovery Locations</h3>
                    
                    <div class="skill-paths">
                        <div style="font-family: 'Patrick Hand', cursive; font-size: 1.2rem; margin-bottom: 15px;">Search Order (Project → Global)</div>
                        
                        <div class="path-item">
                            <span class="path-icon"><i class="fa-solid fa-folder"></i></span>
                            <span class="path-scope">Project:</span>
                            <code>.opencode/skills/&lt;name&gt;/SKILL.md</code>
                        </div>
                        
                        <div class="path-item">
                            <span class="path-icon"><i class="fa-solid fa-folder"></i></span>
                            <span class="path-scope">Global:</span>
                            <code>~/.config/opencode/skills/&lt;name&gt;/SKILL.md</code>
                        </div>
                        
                        <div class="path-item">
                            <span class="path-icon"><i class="fa-solid fa-folder"></i></span>
                            <span class="path-scope">Claude:</span>
                            <code>.claude/skills/&lt;name&gt;/SKILL.md</code>
                        </div>
                        
                        <div class="path-item">
                            <span class="path-icon"><i class="fa-solid fa-cloud"></i></span>
                            <span class="path-scope">Remote:</span>
                            <code>https://example.com/skills-index.json</code>
                        </div>
                    </div>

                    <h3>Skill File Format</h3>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>.opencode/skills/git-release/SKILL.md</span>
                        </div>
                        <div class="code-content">
<span class="comment"># Skill Configuration</span>
<span class="tag">&#45;&#45;&#45;</span>
<span class="attr">name</span><span class="punctuation">:</span> git-release
<span class="attr">description</span><span class="punctuation">:</span> Create consistent releases and changelogs
<span class="attr">license</span><span class="punctuation">:</span> MIT
<span class="attr">compatibility</span><span class="punctuation">:</span> opencode
<span class="attr">metadata</span><span class="punctuation">:</span>
  <span class="attr">audience</span><span class="punctuation">:</span> maintainers
  <span class="attr">workflow</span><span class="punctuation">:</span> github
<span class="tag">&#45;&#45;&#45;</span>

<span class="comment">## What I do</span>

<span class="punctuation">-</span> Draft release notes from merged PRs
<span class="punctuation">-</span> Propose a version bump
<span class="punctuation">-</span> Provide copy-pasteable <span class="string">`gh release create`</span> command

<span class="comment">## When to use me</span>

Use this when preparing a tagged release.
Ask clarifying questions if versioning is unclear.
                        </div>
                    </div>

                    <h3>How Skills Are Loaded</h3>
                    
                    <p>At runtime, OpenCode exposes available skills to agents via the <span class="highlight-coral">skill</span> tool. The agent can then load a skill on-demand:</p>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>Runtime Skill Loading</span>
                        </div>
                        <div class="code-content">
<span class="comment">// Agent sees available skills in tool description</span>
<span class="punctuation">&lt;</span><span class="tag">available_skills</span><span class="punctuation">&gt;</span>
  <span class="punctuation">&lt;</span><span class="tag">skill</span><span class="punctuation">&gt;</span>
    <span class="punctuation">&lt;</span><span class="tag">name</span><span class="punctuation">&gt;</span>git-release<span class="punctuation">&lt;/</span><span class="tag">name</span><span class="punctuation">&gt;</span>
    <span class="punctuation">&lt;</span><span class="tag">description</span><span class="punctuation">&gt;</span>Create consistent releases...<span class="punctuation">&lt;/</span><span class="tag">description</span><span class="punctuation">&gt;</span>
  <span class="punctuation">&lt;/</span><span class="tag">skill</span><span class="punctuation">&gt;</span>
<span class="punctuation">&lt;/</span><span class="tag">available_skills</span><span class="punctuation">&gt;</span>

<span class="comment">// Agent loads skill when needed</span>
<span class="keyword">skill</span><span class="punctuation">({</span> <span class="attr">name</span><span class="punctuation">:</span> <span class="string">"git-release"</span> <span class="punctuation">})</span>
<span class="comment">// Returns full SKILL.md content</span>
                        </div>
                    </div>

                    <h3>Skill Permissions</h3>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>opencode.json</span>
                        </div>
                        <div class="code-content">
<span class="punctuation">{</span>
  <span class="key">"permission"</span><span class="punctuation">:</span> <span class="punctuation">{</span>
    <span class="key">"skill"</span><span class="punctuation">:</span> <span class="punctuation">{</span>
      <span class="key">"*"</span><span class="punctuation">:</span> <span class="string">"allow"</span><span class="punctuation">,</span>           <span class="comment">// Allow all</span>
      <span class="key">"internal-*"</span><span class="punctuation">:</span> <span class="string">"deny"</span><span class="punctuation">,</span>    <span class="comment">// Block internal skills</span>
      <span class="key">"experimental-*"</span><span class="punctuation">:</span> <span class="string">"ask"</span>  <span class="comment">// Prompt user</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
                        </div>
                    </div>

                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Permission</th>
                                <th>Behavior</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>allow</strong></td>
                                <td>Skill loads immediately</td>
                            </tr>
                            <tr>
                                <td><strong>deny</strong></td>
                                <td>Skill hidden from agent, access rejected</td>
                            </tr>
                            <tr>
                                <td><strong>ask</strong></td>
                                <td>User prompted for approval before loading</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Best Practices for Skills</h3>
                    
                    <ol style="margin: 15px 0; padding-left: 25px;">
                        <li><strong>Keep focused</strong> — One domain per skill</li>
                        <li><strong>Write good descriptions</strong> — Helps agent choose correctly</li>
                        <li><strong>Include examples</strong> — Step-by-step instructions work best</li>
                        <li><strong>Version control</strong> — Project-specific skills with code</li>
                        <li><strong>Share via URLs</strong> — Team-wide standards via remote index</li>
                    </ol>
                </section>

                <!-- Key Takeaways -->
                <section class="card reveal" id="key-takeaways">
                    <h2><i class="fa-solid fa-star fa-icon"></i>Key Takeaways</h2>
                    
                    <div class="agent-types">
                        <div class="agent-box" style="background: linear-gradient(145deg, #E8F8F5, #D1F2EB); border-color: var(--accent-green);">
                            <div class="agent-icon" style="color: var(--accent-green);"><i class="fa-solid fa-robot"></i></div>
                            <div class="agent-title">Agents</div>
                            <div class="agent-desc">Specialized AI assistants with custom prompts, models, and permissions</div>
                        </div>
                        
                        <div class="agent-box" style="background: linear-gradient(145deg, #E3F2FD, #BBDEFB); border-color: #2196F3;">
                            <div class="agent-icon" style="color: #2196F3;"><i class="fa-solid fa-book"></i></div>
                            <div class="agent-title">Skills</div>
                            <div class="agent-desc">Reusable instruction documents loaded on-demand via the skill tool</div>
                        </div>
                        
                        <div class="agent-box" style="background: linear-gradient(145deg, #FFF3E0, #FFE0B2); border-color: var(--accent-orange);">
                            <div class="agent-icon" style="color: var(--accent-orange);"><i class="fa-solid fa-toolbox"></i></div>
                            <div class="agent-title">Tools</div>
                            <div class="agent-desc">Capabilities (bash, edit, read, etc.) controlled by permissions</div>
                        </div>
                        
                        <div class="agent-box" style="background: linear-gradient(145deg, #E8EAF6, #C5CAE9); border-color: var(--accent-lavender);">
                            <div class="agent-icon" style="color: var(--accent-lavender);"><i class="fa-solid fa-shield-halved"></i></div>
                            <div class="agent-title">Permissions</div>
                            <div class="agent-desc">Hierarchical pattern system for fine-grained access control</div>
                        </div>
                    </div>

                    <div class="insight-box" style="background: linear-gradient(135deg, #E8F5E9, #C8E6C9); border-color: var(--accent-green);">
                        <i class="fa-solid fa-check-circle insight-icon" style="color: var(--accent-green);"></i>
                        <div>
                            <strong>Remember:</strong> Markdown files are the best way to define project-specific agents and skills. Everything is configurable via JSON, Markdown, or environment variables. OpenCode is provider-agnostic!
                        </div>
                    </div>
                </section>

                <!-- File Structure -->
                <section class="card reveal" id="project-file-structure">
                    <h2><i class="fa-solid fa-folder-tree fa-icon"></i>Project File Structure</h2>
                    
                    <div class="code-block">
                        <div class="code-header">
                            <span class="dot red"></span>
                            <span class="dot yellow"></span>
                            <span class="dot green"></span>
                            <span>Project Structure</span>
                        </div>
                        <div class="code-content">
<span class="path">project/</span>
<span class="punctuation">├──</span> <span class="path">.opencode/</span>
<span class="punctuation">│</span>   <span class="punctuation">├──</span> <span class="attr">opencode.json</span>          <span class="comment"># Project config</span>
<span class="punctuation">│</span>   <span class="punctuation">├──</span> <span class="attr">agents/</span>                <span class="comment"># Custom agents</span>
<span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">├──</span> reviewer.md
<span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">└──</span> security-audit.md
<span class="punctuation">│</span>   <span class="punctuation">├──</span> <span class="attr">skills/</span>                <span class="comment"># Custom skills</span>
<span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">├──</span> react-patterns/
<span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">└──</span> SKILL.md
<span class="punctuation">│</span>   <span class="punctuation">│</span>   <span class="punctuation">└──</span> deployment/
<span class="punctuation">│</span>   <span class="punctuation">│</span>       <span class="punctuation">└──</span> SKILL.md
<span class="punctuation">│</span>   <span class="punctuation">└──</span> <span class="attr">tools/</span>                 <span class="comment"># Custom tools</span>
<span class="punctuation">│</span>       <span class="punctuation">└──</span> my-tool.ts
<span class="punctuation">└──</span> <span class="attr">src/</span>
    <span class="punctuation">└──</span> ...

<span class="comment"># Global config in home directory:</span>
<span class="path">~/.config/opencode/</span>
<span class="punctuation">├──</span> <span class="attr">opencode.json</span>              <span class="comment"># Global config</span>
<span class="punctuation">├──</span> <span class="attr">agents/</span>                    <span class="comment"># Global agents</span>
<span class="punctuation">└──</span> <span class="attr">skills/</span>                    <span class="comment"># Global skills</span>
    <span class="punctuation">├──</span> python/SKILL.md
    <span class="punctuation">└──</span> security/SKILL.md
                        </div>
                    </div>
                </section>

                <footer>
                    <p><i class="fa-solid fa-paintbrush"></i> Mind & Machine | <a href="index.html" style="color: var(--accent-teal);">Back to Home</a></p>
                </footer>
            </div>
        </main>
    </div>

    <script>
        // Scroll reveal animation
        const revealElements = document.querySelectorAll('.reveal');
        const revealOnScroll = () => {
            revealElements.forEach(el => {
                const elementTop = el.getBoundingClientRect().top;
                const windowHeight = window.innerHeight;
                if (elementTop < windowHeight - 80) {
                    el.classList.add('visible');
                }
            });
        };
        window.addEventListener('scroll', revealOnScroll);
        window.addEventListener('load', revealOnScroll);

        // Sidebar toggle for mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // Smooth scroll to section
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
                // Close sidebar on mobile after clicking
                if (window.innerWidth <= 1200) {
                    document.getElementById('sidebar').classList.remove('open');
                }
            }
        }

        // Active section highlighting in TOC
        const sections = document.querySelectorAll('section[id]');
        const tocLinks = document.querySelectorAll('.toc-list a');

        const highlightTOC = () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        };

        window.addEventListener('scroll', highlightTOC);
        window.addEventListener('load', highlightTOC);
    </script>
</body>
</html>